<!DOCTYPE html>
<html>
   <head>
      <title>Hello world</title>
   </head>
   <script src = "/socket.io/socket.io.js"></script>
   <body>
     Hello world
     <h1 onclick="resetNumbers()">RESET</h1>

     <pre class="output"></pre>

   </body>


        <script>
          var socket = io();
          var output = document.querySelector('.output');
          var resetX = 0;
          var resetY = 0;

          var event_x = 0;
          var event_y = 0;

          function handleOrientation(event) {
            var x = (event.alpha - resetX);  // In degree in the range [0, 360]
            var y = (event.gamma - resetY); // In degree in the range [-90,90]
            event_x = event.alpha;
            event_y = event.gamma;

           while (x < -90 || x > 90) {
             if (x < -90) { x += 180 };
             if (x > 90)  { x -= 180 };
           }

           while (y < -90 || y > 90) {
             if (y < -90) { y += 180 };
             if (y > 90)  { y -= 180 };
           }

            output.innerHTML  = "alpha : " + -x + "\n";
            output.innerHTML += "gamma: " + -y + "\n";

            socket.emit('clientEvent', "Alpha: " + -x + "     Gamma: " + -y);
          }

          function resetNumbers() {
            resetX = event_x;
            resetY = event_y;
          }

          window.addEventListener('deviceorientation', handleOrientation);
        </script>
</html>
